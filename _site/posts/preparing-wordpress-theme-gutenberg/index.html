<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Preparing a WordPress theme for Gutenberg – Sam Hermes</title>
<meta name="description"
    content="As the launch of Gutenberg gets closer and closer, now is as good a time as any to make preparations. My theme that is live in the theme directory, Halle, wo...">

<link rel="stylesheet" href="/css/main.css?v=1.0.8">

<link rel="canonical" href="http://localhost:4000/posts/preparing-wordpress-theme-gutenberg/">
<link rel="alternate" type="application/rss+xml" title="Sam Hermes"
    href="http://localhost:4000/feed.xml">
<link rel="alternate" type="application/json" title="Sam Hermes"
    href="http://localhost:4000/feed.json" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-133352732-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-133352732-1');
</script>


<body class="page-preparing-a-wordpress-theme-for-gutenberg">
    <header class="site-header group">
	<div class="contain">
    <a class="logotype" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="295" height="36" viewBox="0 0 295 36"><path fill="#ffffff" d="M.24 28.08l4.46-3.52c2.5 4.04 5.98 5.92 10.3 5.92 4.61 0 7-2.26 7-5.36 0-4.09-4.37-4.89-8.98-5.87-5.3-1.09-10.94-2.5-10.94-9.36 0-5.36 4.89-9.82 11.8-9.82 5.87 0 9.73 2.11 13.06 5.87l-4.23 3.34c-2.02-2.73-4.37-4.56-8.83-4.56-4.61 0-6.53 2.16-6.53 5.12 0 3.48 4.04 4.14 8.51 5.08 5.4 1.13 11.42 2.68 11.42 10.15 0 5.26-4.32 10.25-12.13 10.25C8 35.32 3.49 32.5.24 28.08zM31.36 27.84c0-5.22 4.32-8.41 11.42-8.41h7.52v-.42c0-3.38-2.07-5.73-6.58-5.73-3.34 0-5.83 1.6-7.28 4.09l-4.51-2.63c2.49-3.34 6.39-5.78 11.84-5.78 7.28 0 11.42 4.04 11.42 10.2v15.7H50.3V30.4c-2.02 3.01-5.73 4.98-9.96 4.98-5.88-.02-8.98-3.26-8.98-7.54zm18.94-2.25v-2.12h-7.19c-4.7 0-6.58 1.46-6.58 3.95 0 2.21 1.5 3.52 4.89 3.52 3.61.01 7.23-2.02 8.88-5.35zM60.92 9.47h5.03v2.91c1.55-2.12 3.95-3.43 7.19-3.43 4.04 0 6.72 1.69 8.08 4.46 1.6-2.68 4.51-4.46 8.27-4.46 6.96 0 10.2 4.18 10.2 10.72v15.18h-5.22v-14.9c0-3.95-1.74-6.53-5.73-6.53-3.62 0-5.97 2.35-5.97 7v14.43h-5.12V19.62c0-3.85-1.74-6.2-5.59-6.2-3.76 0-6.06 2.44-6.06 7.24v14.19h-5.08V9.47zM138.84 20.04h-16.45v14.8h-5.12V.54h5.12v14.62h16.45V.54h5.08v34.31h-5.08V20.04zM148.76 22.25c0-7.47 5.73-13.3 13.21-13.3s13.02 5.45 13.02 12.97v2.12h-21.34c.75 4.09 3.95 6.81 8.6 6.81 3.57 0 5.92-1.64 7.43-4.09l4.18 2.49c-2.44 3.67-6.11 6.11-11.61 6.11-8.08 0-13.49-5.73-13.49-13.11zm5.08-2.54h16.03c-.75-3.99-3.71-6.3-7.9-6.3-4.04.01-7.15 2.64-8.13 6.3zM179.88 9.47h4.98v4.42c1.08-3.2 3.67-4.79 6.91-4.79 1.74 0 3.29.38 4.28.99l-1.97 4.89c-.7-.47-1.74-.75-3.2-.75-3.62 0-5.92 1.79-5.92 6.34v14.29h-5.08V9.47zM200.04 9.47h5.03v2.91c1.55-2.12 3.95-3.43 7.19-3.43 4.04 0 6.72 1.69 8.08 4.46 1.6-2.68 4.51-4.46 8.27-4.46 6.96 0 10.2 4.18 10.2 10.72v15.18h-5.22v-14.9c0-3.95-1.74-6.53-5.73-6.53-3.62 0-5.97 2.35-5.97 7v14.43h-5.12V19.62c0-3.85-1.74-6.2-5.59-6.2-3.76 0-6.06 2.44-6.06 7.24v14.19h-5.08V9.47zM243.61 22.25c0-7.47 5.73-13.3 13.21-13.3 7.47 0 13.02 5.45 13.02 12.97v2.12H248.5c.75 4.09 3.95 6.81 8.6 6.81 3.57 0 5.92-1.64 7.43-4.09l4.18 2.49c-2.44 3.67-6.11 6.11-11.61 6.11-8.09 0-13.49-5.73-13.49-13.11zm5.07-2.54h16.03c-.75-3.99-3.71-6.3-7.9-6.3-4.04.01-7.14 2.64-8.13 6.3zM272.75 29.77l4.56-2.58c1.55 2.4 3.71 3.76 6.86 3.76 3.29 0 5.03-1.64 5.03-3.57 0-2.21-3.1-2.72-6.44-3.43-4.28-.89-8.84-2.3-8.84-7.47 0-3.95 3.81-7.61 9.78-7.57 4.75 0 7.99 1.74 10.2 4.75l-4.37 2.49c-1.27-1.88-3.1-3.01-5.83-3.01-3.1 0-4.61 1.46-4.61 3.24 0 2.02 2.3 2.49 6.16 3.34 4.23.89 9.02 2.35 9.02 7.61 0 3.71-3.34 8.08-10.34 8.04-5.36-.01-9.02-1.93-11.18-5.6z"/></svg><span class="screen-reader-text">Sam Hermes</span></a>
    <ul class="site-nav">
      <li><a href="/posts">Posts</a></li>
      <li><a href="/projects">Projects</a></li>
    </ul>
   	</div>
</header>

    <div class="page">
        <article class="post">

  <header class="post-header">
    <p class="post-meta"><time>August 12, 2018</time></p>
    <h1 class="post-title">Preparing a WordPress theme for Gutenberg</h1>
  </header>

  <div class="post-content">
    <p>As the launch of Gutenberg gets closer and closer, now is as good a time as any to make preparations. My theme that is live in the theme directory, <a href="https://wordpress.org/themes/halle/">Halle</a>, works fairly well with Gutenberg without any changes, but there are some small modifications that I’d like to make to improve the overall experience and to take full advantage of what Gutenberg offers.</p>

<h2 id="matching-editor-styles-to-the-front-end">Matching editor styles to the front end</h2>

<p>Gutenberg is fantastic for the way it allows the back end editing experience to mirror the front end display, if you desire. With some slight modifications, it’s really easy to bring the styles into alignment. Just to start, you can register the same Google Fonts in the editor.</p>

<p>This is fairly similar to the <code class="highlighter-rouge">wp_enqueue_scripts</code> action that is typically used for front end styles, the difference is that <code class="highlighter-rouge">enqueue_block_editor_assets</code> just enqueues the styles in the Gutenberg editor.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="nf">halle_block_editor_styles</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wp_enqueue_style</span><span class="p">(</span> <span class="s1">'halle-editor-fonts'</span><span class="p">,</span> <span class="s1">'https://fonts.googleapis.com/css?family=Work+Sans:400,500,700|Poly:400,400i'</span> <span class="p">);</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">'enqueue_block_editor_assets'</span><span class="p">,</span> <span class="s1">'halle_block_editor_styles'</span> <span class="p">);</span>
</code></pre></div></div>

<p>Previously, I was adding Google fonts to the editor using <code class="highlighter-rouge">add_editor_style( )</code> and passing in the stylesheet URL. As some users will still be using the classic editor, and some will use Gutenberg, I’ll leave both of these in place. I’m not sure when I’ll be able to remove the old <code class="highlighter-rouge">add_editor_style()</code> declaration, but I’d say that I would leave it in for a year or so as users upgrade and transition.</p>

<p>Now that the fonts are enqueued, we need to use them for the post/page title and other text blocks. I created a new Sass file called <code class="highlighter-rouge">block-editor-styles.scss</code> in the theme, and enqueued it inside of the <code class="highlighter-rouge">halle_block_editor_styles()</code> function that I used above.</p>

<p>Taking a cue from the <a href="https://wordpress.org/gutenberg/handbook/extensibility/theme-support/#editor-styles">Gutenberg Handbook</a>, I started with a parent selector of <code class="highlighter-rouge">body.block-editor-page</code>, and then nested all of the following styles within.</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.edit-post-visual-editor</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="s2">'Poly'</span><span class="p">,</span> <span class="nb">serif</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">.edit-post-visual-editor</code> class is a parent class for the editor, so this font family declaration cascades down into most elements in the editor. Gutenberg’s styles are taking the same approach, so overriding using this method is easy.</p>

<p>Although the cascade works fairly well, both the post title and paragraphs need just a bit more specificity to override. Again, these are both nested inside of <code class="highlighter-rouge">body.block-editor-page</code>.</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.editor-post-title__input</span><span class="o">,</span>
<span class="nt">p</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="s2">'Poly'</span><span class="p">,</span> <span class="nb">serif</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I could go further with these styles, but your theme will likely differ from mine. The next item that I addressed was the <code class="highlighter-rouge">max-width</code> of each block. You can see how I accomplished this and some other modifications <a href="https://github.com/samhermes/halle/blob/gutenberg/sass/block-editor-style.scss">in the Halle repo on GitHub</a>.</p>

<h2 id="customizing-block-styles">Customizing block styles</h2>

<p>Out of the box, Gutenberg provides a range of blocks. By default, Gutenberg serves a new core blocks stylesheet to the front of your site to properly style each block. At the moment, the handbook states that these styles are an opt-in feature, but that doesn’t seem to be the case, as they are being served up without any additional action.</p>

<p>At the moment, blocks will generally look the same in both the editor and the front end, but they likely will not fit with the style of your theme. Handling this will vary by instance. I am going to start with what Gutenberg offers and slightly modify from there. Fortunately, Gutenberg has block-specific classes that it applies to each element, so any styles that I add will not interfere with anyone who does not yet have Gutenberg in use.</p>

<p>For now, I am just modifying a few blocks, as these seem to be the most opinionated (as far as styles go) of the core blocks.</p>

<h3 id="button">Button</h3>

<p>The button block has a number of options associated with it, but I primarily wanted to reduce the border radius (everything is so round now?!). This was accomplished by using <code class="highlighter-rouge">.wp-block-button.wp-block-button__link</code>.</p>

<h3 id="block-quote">Block Quote</h3>

<p>The <code class="highlighter-rouge">blockquote</code> styles provided by Gutenberg aren’t too specific, but in my case, I needed to add support for the <code class="highlighter-rouge">blockquote</code> citation that is now available. Previously, I was relying on the bottom margin of the <code class="highlighter-rouge">blockquote</code> paragraph element, and needed to shift that to the <code class="highlighter-rouge">blockquote</code> element itself.</p>

<h3 id="horizontal-rule">Horizontal Rule</h3>

<p>Gutenberg offers three <code class="highlighter-rouge">&lt;hr&gt;</code> styles: short line, wide line, and dots. Previously, I was using a background color to provide the rule, but this interferes with how Gutenberg styles rules. I transitioned my styles from <code class="highlighter-rouge">background: #ccc</code> to <code class="highlighter-rouge">border-top: 1px solid #ccc</code>.</p>

<p>The confusing part here is that Gutenberg defaults to the short line style, but currently doesn’t serve styles for it to the front end, only for the wide line and dots styles. So, if nothing is done, the short and wide lines look the same on the front end. I’ve added styles to Halle’s stylesheet to remedy this.</p>

<h2 id="enabling-wide-images">Enabling wide images</h2>

<p>Wide images are the biggest reason to revisit the layout of your theme. In Halle, individual posts have a sidebar when the screen is wide enough to accommodate it. This is not conducive to wide images. This led me to question whether or not I could make the layout an option, so that the user could choose the sidebar layout, or a centered layout.</p>

<p>To enable wide images, all that is required is the following, added to <code class="highlighter-rouge">after_setup_theme</code>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">add_theme_support</span><span class="p">(</span> <span class="s1">'align-wide'</span> <span class="p">);</span>
</code></pre></div></div>

<p>There are several approaches to take to support wide images on the front end. You could make the parent element of the post content 100% width, and then place a <code class="highlighter-rouge">max-width</code> on everything except for wide images. Or, instead, you could break the wide images out of the container. This method is described in <a href="https://www.billerickson.net/getting-your-theme-ready-for-gutenberg/">this article from Bill Erickson</a>. I prefer the former approach.</p>

<p>I haven’t implemented wide images in Halle yet, as this will involve much deeper changes to the foundational layout of the theme, and there’s already enough change happening. I’ll come back to this at a later time.</p>

<h2 id="color-palettes">Color palettes</h2>

<p>If your theme contains a specific color palette, or you are working with brand colors, customizing the color palette available to users is a great way to encourage consistency. I won’t go into how to accomplish this specifically, but it’s worth noting that this is available. More information is detailed in the <a href="https://wordpress.org/gutenberg/handbook/extensibility/theme-support/#block-color-palettes">Gutenberg Handbook</a>.</p>

  </div>

  
  <ul class="categories-list">
    
    <li><a
        href="/category/wordpress">WordPress</a>
    </li>
    
  </ul>
  

  <div class="about-me">
    <img src="/img/samhermes.jpg" alt="Sam Hermes">
    <div class="about-me-text">
      <p class="name">Sam Hermes</p>
      <p class="description">I'm a web developer at Washington University in St. Louis. I write about WordPress, CSS,
        JS, accessibility, and more.</p>
      <p><a href="/about">More About Me</a></p>
    </div>
  </div>
</article>
    </div>
    <footer class="site-footer group">
	<div class="contain">
		<ul class="site-nav">
			<li><a href="/about">About</a></li>
			<li><a href="/lists">Lists</a></li>
			<li><a href="https://samhermes.typeform.com/to/d4C4FT">Contact</a></li>
		</ul>

		<ul class="social">
			<li>
				<a href="https://teamtreehouse.com/samhermes">
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><path d="M17.5 0C7.8 0 0 7.8 0 17.5S7.8 35 17.5 35 35 27.2 35 17.5 27.2 0 17.5 0zM28 22.1c0 .7-.5 1.6-1.1 1.9l-8.3 4.7c-.6.3-1.6.3-2.2 0L8.1 24c-.6-.3-1.1-1.2-1.1-1.9v-9.2c0-.7.5-1.6 1.1-1.9l8.3-4.7c.6-.3 1.6-.3 2.3.1l1.2.7c.7.4.7 1.5.1 2.6l-1.3 1.9c-.5 1-1.7 1.9-2.8 2.1h-.3c-1 .2-2.3-.1-2.8-.1-.3 0-.6.1-.8.3-.6.5-.7 1.3-.3 1.9.5.6 1.3.7 1.9.3l.3-.3c.2-.1.8-.2 1.5-.3h.4l1.8-1-2.1 1.6c-.1.1-.3.2-.4.3-.7.5-2 1.3-2.4 1.4l-.6.3c-.6.5-.7 1.5-.2 2.1.5.6 1.5.7 2.1.2.2-.2.3-.3.4-.5.2-.3.5-.7.8-1 .2-.1.6-.4.8-.6.4-.3.5-.3.5 0l.9-1.8-.8 3v.2l-.3.9c-.2.5-.3 1-.4 1l-.1.1c-.8.4-1.1 1.5-.7 2.3.4.8 1.5 1.1 2.3.7.8-.4 1.1-1.5.7-2.3 0-.1-.1-.1-.1-.2s.2-1 .5-2v-.1c.4-1 1.3-2 1.8-1.5.4.5.5 1.1.5 1.4-.1.2-.1.4 0 .6.3.8 1.1 1.2 1.9 1 .2-.1.4-.2.6-.4.6-.5.7-1.5.1-2.1-.3-.3-1.1-1.1-1.7-2V17c-.6-.9-.7-2-.2-3l1.3-2.3c.7-1.2 1.9-1.9 2.7-1.5l1.4.8c.6.3 1.1 1.2 1.1 1.9v9.2z" fill="#090909"/></svg>
					<span class="screen-reader-text">Sam Hermes on Treehouse</span>
				</a>
			</li>
			<li>
				<a href="https://codepen.io/samhermes">
					<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35"><path fill="#090909" d="M8.6 16v3l2.3-1.5zM16.6 13.7V9.4l-7.3 4.8 3.3 2.2zM25.7 14.2l-7.3-4.8v4.3l4 2.7zM9.3 20.8l7.3 4.8v-4.3l-4-2.7zM18.4 21.3v4.3l7.3-4.8-3.3-2.2zM17.5 15.3l-3.3 2.2 3.3 2.2 3.3-2.2z"/><path fill="#090909" d="M17.5.1C7.9.1.1 7.9.1 17.5c0 9.6 7.8 17.4 17.4 17.4 9.6 0 17.4-7.8 17.4-17.4C34.9 7.9 27.1.1 17.5.1zm10.8 20.7v.5h-.1L18 28.1c-.2.1-.3.2-.5.2s-.4-.1-.5-.2l-9.8-6.6h-.1v-.1-.1-.1-.1V14.4v-.1-.1-.1-.1-.1h.1l9.8-7c.3-.2.7-.2 1 0l9.8 6.6h.1v7.3z"/><path fill="#090909" d="M26.4 19v-3l-2.3 1.5z"/></svg>
					<span class="screen-reader-text">Sam Hermes on CodePen</span>
				</a>
			</li>
			<li>
				<a href="https://github.com/samhermes">
					<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35"><path fill-rule="evenodd" clip-rule="evenodd" fill="#090909" d="M17.5 0C7.8 0 0 7.9 0 17.5c0 7.7 5 14.3 12 16.6.9.2 1.2-.4 1.2-.8v-3c-4.9 1.1-6-2.3-6-2.3-.8-2-1.9-2.6-1.9-2.6-1.6-1.1.1-1.1.1-1.1 1.8.1 2.7 1.8 2.7 1.8 1.6 2.7 4.1 1.9 5.1 1.5.2-1.1.6-1.9 1.1-2.3-3.9-.4-8-1.9-8-8.6 0-1.9.7-3.5 1.8-4.7-.1-.5-.7-2.3.2-4.7 0 0 1.5-.5 4.8 1.8 1.4-.4 2.9-.6 4.4-.6 1.5 0 3 .2 4.4.6 3.3-2.3 4.8-1.8 4.8-1.8 1 2.4.4 4.2.2 4.6 1.1 1.2 1.8 2.8 1.8 4.7 0 6.7-4.1 8.2-8 8.6.6.5 1.2 1.6 1.2 3.2v4.8c0 .5.3 1 1.2.8 6.9-2.3 12-8.9 12-16.6C35 7.9 27.2 0 17.5 0z"/></svg>
					<span class="screen-reader-text">Sam Hermes on GitHub</span>
				</a>
			</li>
		</ul>
	</div>
</footer>




<script src="/js/prism.js"></script>




</html>
</body>